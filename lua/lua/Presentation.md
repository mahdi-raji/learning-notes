
**مقدمه**
<img src="attachments/Pasted%20image%2020250502141953.png" width="300px">

- در زبان پرتغالی LUA به معنای moon یا ماه می‌باشد . 
- 
- زبانی سبک ، high level و multi paradigm (الگو های برنامه نویسی متفاوت : Scripting, Procedural,Functional , Reflective , OOP) است که در سال ۱۹۹۳ توسط سه پژوهشگر برزیلی به نام‌های Roberto Ierusalimschy ، Luiz Henrique de Figueiredo و Waldemar Celes طراحی شد.
- به‌صورت کامل با زبان ANSI C پیاده‌سازی شده.
- از همان ابتدا به‌گونه‌ای طراحی شد که بتواند به راحتی به عنوان یک زبان extension مورد استفاده قرار گیرد، به این معنا که توسعه‌دهندگان بتوانند با استفاده از Lua، قابلیت‌های جدیدی را به برنامه‌های موجود اضافه کنند.
-  دلیل انتخاب این نام تاریخی جالب دارد: تیم توسعه در حال کار روی نسخه‌ی جدید زبانی قبلی به نام SOL (به پرتغالی «خورشید») بودند. یکی از همکاران در Tecgraf (Carlos Henrique Levy) پیشنهاد کرد زبان جدید را «Lua» (ماه) بنامند که در کنار نام SOL (خورشید) معنا دارد بدین ترتیب نام Lua انتخاب شد تا ارتباطی نمادین با زبان پیشین SOL برقرار باشد.

- از ابتدا بر چند اصل کلیدی بنا شد: سادگی، کوچکی، قابلیت حمل و قابلیت embed در برنامه‌های کاربردی
-  پیاده‌سازی آن بسیار سبک است و در سیستم‌عامل‌های مختلف اجرا می‌شود. یکی از ویژگی‌های بارز Lua استفاده از یک ساختار داده اساسی است: «جدول».
- این جدول‌ها در Lua آرایه‌های انجمنی (associative arrays) هستند که امکان استفاده از انواع مختلفی از مقادیر به‌عنوان کلیدها را فراهم می‌کنند. در واقع، جدول‌ها در Lua اجازه می‌دهند که مقادیر مختلفی از جمله مجموعه‌ها، ساختارهای پیوندی و دیگر ساختارهای داده به‌سادگی پیاده‌سازی شوند. از طرف دیگر، با استفاده از اعداد طبیعی به‌عنوان ایندکس‌ها می‌توانیم از جداول برای پیاده‌سازی آرایه‌ها استفاده کنیم. یکی از ویژگی‌های مهم Lua این است که این جداول، علی‌رغم اینکه آرایه‌هایی با ایندکس‌های عددی هستند، به‌طور داخلی به‌عنوان آرایه‌های واقعی پیاده‌سازی می‌شوند و از لحاظ استفاده از حافظه و عملکرد بهینه عمل می‌کنند .
-   شریک اصلی در توسعه نرم‌افزارهای Tecgraf در واقع Petrobras است ک هیکی از برگترین شرکت های نفی در بریزل می باشد. این شرکت نقش کلیدی در شکل‌گیری زبان برنامه‌نویسی Lua داشت، چرا که یکی از اصلی‌ترین اهداف تیم Tecgraf از توسعه زبان Lua، پاسخ به نیازهای Petrobras بود. 
- در واقع Petrobras به Tecgraf درخواست داده بود که درخواست‌های گرافیکی برای وارد کردن داده‌ها طراحی شوند که به کاربران این امکان را می‌دهد که به‌صورت تعاملی داده‌ها را وارد کنند. به این ترتیب، برنامه‌نویسان نیازی به ویرایش دستی ستون‌های اعداد نداشتند. بلکه تنها با کلیک کردن روی بخش‌های مربوط به یک نمودار، اطلاعات مورد نیاز برای شبیه‌سازی وارد می‌شد. همچنین از آنجا که ورودی‌ها به صورت خودکار تولید می‌شدند، این فرآیند هم ساده‌تر و هم مطمئن‌تر بود. پس به همین دلیل نیاز به یک زبان برنامه نویسی داشتند . 
- قبل تر دو زبان برنامه نویسی ساخته شده بود که DEL (Data-Entry Language) و SOL (Simple Object Language) بودند که درواقع زبان های Domain Specific بودند و lua درواقع نتیجه گسترش این دوزبان بر اساس نیاز های Petrobras بود.
-  در یک نگاه کلی، فلسفه طراحی Lua بر سادگی عمل و عدم پیچیدگی اضافی متمرکز بود. هیچ مفهوم عجیب و جدیدی در Lua معرفی نشد؛ توسعه‌دهندگان آن چیزهایی را که در زبان‌های دیگر دیده بودند برداشتند و مطابق سلیقه و نیاز خود بازآرایی کردند . در نتیجه Lua به زبانی تبدیل شد که به راحتی می‌توان آن را در برنامه‌های C جاسازی (Embed) کرد، برای کاربران غیرتخصصی قابل فهم است، و در عین حال ویژگی‌های قدرتمندی برای توسعه برنامه‌ها ارائه می‌دهد .
- 
![](attachments/Pasted%20image%2020250502132842.png)


![](attachments/Pasted%20image%2020250502141845.png)
Roberto Ierusalimschy




 **Scripting Language**
![](attachments/Pasted%20image%2020250427065148.png)


برای مثال
ما از طریق زبان اسکریپت های زبان lua و ارتباط گرفتن با api  wow میتونیم یه سری اسکریپت بنویسیم که مثلا ببینیم چندتا quest فعال داریم و نتیجه رو داخل chat بازی برای خودمون ببینیم :
```lua

local numQuests = C_QuestLog.GetNumQuestLogEntries()
print("You currently have " .. numQuests .. " quests active.")

```



**Difference Between Interpreted and Scripting Languages**

- منظور از Scripting هدف استفاده از زبان می‌باشد ولی منظور از Interpreted به روش اجرا اشاره می‌شود. ممکن است زبان های اسکریپتی امروزه نیز با Jit Compiler ها اجرا شوند . ( Just In Time Compile ) این روش بخشی از کد را در زمان اجرا به کد ماشین تبدیل می‌کند تا سرعت اجرا افزایش یابد. برای مثال، موتورهای جاوااسکریپت مثل V8 در مرورگر کروم از این روش استفاده می‌کنند 

**Table**
- در واقع تنها ساختمان داده موجود در زبان lua .
- در واقع و در اصل یک Associative array است که علاوه بر عدد به عنوان اندیس ، از string و یا هر مقدار دیگری نیز پشتیبانی می‌کند.
> a = {} -- create a table and assign its reference
> k = "x"
> a[k] = 10 -- new entry, with key="x" and value=10
> a[20] = "great" -- new entry, with key=20 and value="great"
> a["x"]
 --> 10
> k = 20
> a[k]
 --> "great"
> a["x"] = a["x"] + 1 -- increments entry "x"
> a["x"]
 --> 11
> a.x = 10 -- same as a["x"] = 10
> a.x -- same as a["x"]
--> 10 
> a.y  -- same as a["y"]
--> nil


***Table Traversal***
1- Pairs :We can traverse all key–value pairs in a table with the pairs iterator without any specific order :

```lua
t = {10, print, x = 12, k = "hi"}
for k, v in pairs(t) do
print(k, v)
end
```

>
--> 1 10
--> 2 function: 0x420610
--> k hi
--> x 12

ipairs : For lists, we can use the ipairs iterator:
```lua
t = {10, print, 12, "hi"}
for k, v in ipairs(t) do
print(k, v)
end
```

>
--> 1 10
--> 2 function: 0x420610
--> 3 12
--> 4 hi

In this case, Lua ensures the order.

```lua
t = {10, print, 12, "hi"}
for k = 1, #t do
print(k, t[k])
end
```
>
--> 1 10
--> 2 function: 0x420610
--> 3 12
--> 4 hi

The Problem With # ( Length Operator):

```lua
a = {}
a[1] = 1
a[10000] = 1
```



![](attachments/Pasted%20image%2020250428072615.png)
- محاسبه‌ی آدرس رجیستر جدول: با RA(i) آدرس رجیستر مقصد (مثل R0) تعیین می‌شه.
- خواندن اندازه‌ی هَش: آرگومان B (log2 اندازه‌ی هَش + ۱) خوانده و به 2 به توان b-1  تبدیل می‌شه.
- خواندن اندازه‌ی آرایه: آرگومان C به‌عنوان اندازه‌ی اولیه‌ی آرایه خوانده می‌شه.
- تبدیل هَش سایز: اگه B > 0، اندازه‌ی واقعی هَش با شیفت بیت محاسبه می‌شه.
- تأیید آرگومان اضافی: با lua_assert سازگاری بیت k و آرگومان Ax چک می‌شه. در صورت وجود آرگومان اضافی، اندازه‌ی آرایه آپدیت و pc افزایش می‌یابد.



منابع :
- [سایت رسمی lua](https://www.lua.org/)
- [The Evolution of Lua ](https://www.lua.org/doc/hopl.pdf#:~:text=interface.%20Around%20mid,it%20has%20not%20changed%20since)
- [Source Code of Lua](https://github.com/lua/lua)
- [Programming in lua book](https://raw.githubusercontent.com/Alessana/ebooks/refs/heads/master/Programming%20in%20Lua%204th%20Edition.pdf)

